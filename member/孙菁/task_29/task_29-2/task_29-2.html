<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>task 29-2</title>
	<script src="../jquery-3.0.0.min.js"></script>
	<style>
	    /* public */
		*{
			margin: 0;
			padding: 0;
		}
		li { list-style: none; }
		a{ text-decoration: none; }
		.clear:after {
			display: block;
			content: "";
			clear: both;
		}
		/* end public */

		ul.lz-load {
			width: 876px;
			margin: 0 auto;
		}
		ul.lz-load li {
			float: left;
			padding: 10px;
			margin: 10px;
			border: 1px solid #ccc;
		}
		ul.lz-load img {
			width: 250px;
			height: 300px;
		}
	</style>
</head>
<body>
	<ul class="lz-load clear">
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/1.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/2.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/3.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/4.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/5.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/6.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/7.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/8.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/9.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/10.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/11.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/12.jpg"></a>
		</li><li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/13.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/14.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/15.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/16.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/17.jpg"></a>
		</li>
		<li>
			<a href="#"><img src="imgs/load.jpg" data-src="imgs/18.jpg"></a>
		</li>
	</ul>

	<script>
		var clock;
		$(window).on('scroll',function(){
			if(clock){                          //鼠标滚动一次有多次事件响应，这里只在最后一次响应
				clearTimeout(clock);
			}
			clock = setTimeout(function(){
				checkShow();
			},300);		
		});

		checkShow();        //第一次打开页面时还未滚动窗口需要执行一次

		function checkShow(){
			$("ul.lz-load img").each(function(){
				var $this = $(this);

				if( $this.attr('loaded') ){
					return;
				}

				if( isShow($this) ){
					showImg($this);
				}
			});
		}

		function isShow($el){
			var winH = $(window).height(),
			    scrollTop = $(window).scrollTop(),
			    offsetTop = $el.offset().top;

			if( winH + scrollTop > offsetTop){
				return true;
			}else{
				return false;
			} 
		}

		function showImg($el){
			$el.attr('src',$el.attr('data-src'));
			$el.attr('loaded',true);
		}
	</script>
</body>
</html>