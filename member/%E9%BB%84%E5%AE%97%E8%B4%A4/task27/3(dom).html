<!DOCTYPE html>
<html>
<head>
	<meta charset = "utf-8">
	<title>carousel</title>
	<style>
		*{
			margin:0;padding:0;
		}
		ul,li{
			list-style: none;
		}
		a{
			text-decoration: none;
		}
		.carousel{
			width:480px;
			height:360px;
			overflow: hidden;
			position:relative;
		}
		.img-ct{
			position:absolute;
		}
		.carousel .img-ct li{
			float:left;
		}
		.arrow{
			position:absolute;
			width:30px;height:30px;
			border-radius: 50%;
			top:50%;
			transform: translateY(-50%);
			background: #333;
			opacity: 0.8;
			color:#FFF;
			line-height: 30px;
			text-align: center;
		}
		.arrow:hover{
			opacity: 1;
		}
		.next{
			right:20px;
		}
		.prev{
			left:20px;
		}
		.bullet{
			position: absolute;
			bottom:20px;
			left:50%;
			transform: translateX(-50%);
		}
		.bullet li{
			width:20px;height:6px;
			border-radius: 3px;
			float:left;
			background: #666;
			margin-right: 10px;
			cursor: pointer;
		}
		.bullet li.active{
			background: #FFF;
		}
	</style>
</head>
<body>
	<div class="carousel">
		<ul class="img-ct">
			<li><a href="#"><img src="4.jpg"></a></li>
			<li><a href="#"><img src="1.jpg"></a></li>
			<li><a href="#"><img src="2.jpg"></a></li>
			<li><a href="#"><img src="3.jpg"></a></li>
		</ul>
		<a href="#" class="arrow next">></a>
		<a href="#" class="arrow prev"><</a>
		<ul class="bullet">
			<li class="active"></li>
			<li></li>
			<li></li>
			<li></li>
		</ul> 
	</div>
	<script src="../jquery-3.1.1.min.js"></script>
	<script>
		var $ct = $(".img-ct"),
			$items = $ct.children(),
			$next = $(".next"),
			$prev = $(".prev"),
			$bullet = $(".bullet"),
		    imgWidth = $items.width(),
			imgCount = $items.length,
			curIdx = 0,
			isAnimate = false;

		
		
		var imgRealCount = $ct.children().length;
		$ct.css({ left:0-imgWidth , width:imgRealCount*imgWidth });

		$("a").on("click",function(event){
			event.preventDefault();
		});

		$next.on("click",function(){
			playNext();
		});
		$prev.on("click",function(){
			playPrev();
		});
		$bullet.find("li").on("click",function(){
			var idx = $(this).index();
			if( idx > curIdx){
				playNext(idx-curIdx);
			}
			else if( idx < curIdx){
				playPrev(curIdx-idx);
			}
		});

		function playNext(idx){
			var idx = idx || 1;
			if(isAnimate) return;
			$ct.animate({ left:'-='+(idx*imgWidth) },function(){
				curIdx+=idx;
				console.log(curIdx);
				if(curIdx == imgCount){
					$ct.css({left:0-imgWidth});
					curIdx = 0;
				}
				for(var i=0;i<idx;i++){
					$ct.append( $ct.children().first());
					$ct.css({left:0-imgWidth});
				}
				
				isAnimate = false;
				setBullet();
			});
		};

		function playPrev(idx){
			var idx = idx || 1;
			if(isAnimate) return;
			$ct.animate({ left:'+='+(idx*imgWidth)},function(){
				curIdx = (imgCount+curIdx-idx)%imgCount;
				if(curIdx==(imgCount-1)){
					$ct.css({left:0-imgWidth*imgCount});
				}
				for(var i=0;i<idx;i++){
					$ct.prepend( $ct.children().last());
					$ct.css({left:0-imgWidth});
				}
				
				isAnimate = false;
				setBullet();
			});
		};
		function setBullet(){
			//console.log(curIdx);
			$bullet.children().removeClass("active")
							  .eq(curIdx).addClass("active");
		};
		function autoPlay(){
			clock = setInterval(function(){
				playNext();
			},3000);
		};
		function stopAuto(){
			clearInterval(clock);
		};

	</script>	

</body>
</html>